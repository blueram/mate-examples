<?xml version="1.0" encoding="utf-8"?>
<s:Panel 
	xmlns:fx="http://ns.adobe.com/mxml/2009"
	xmlns:s="library://ns.adobe.com/flex/spark"
	xmlns:mx="library://ns.adobe.com/flex/mx"
	xmlns:mate="http://mate.asfusion.com/"
	xmlns:model="com.cafetownsend.model.vos.*"
	title="Employee Details" 
	>


	
	<fx:Script>
		<![CDATA[
			import com.cafetownsend.ui.presenters.EmployeeDetailPresentationModel;
			import mx.controls.Alert;
            import mx.events.CloseEvent;
			
			[Bindable]
			public var model:EmployeeDetailPresentationModel;

			// the delete button's click event is an Alert asking them to verify the delete
			// the Alert's closeHandler is directed here to be mutated into a method in 
			// the presentation model if the answer was OK
			private function deleteEmployee( closeEvent:CloseEvent ) : void 
			{
				// was the Alert event an OK
				if ( closeEvent.detail == Alert.OK ) 
				{
                	model.deleteEmployee();
				}
			}
			
		]]>
	</fx:Script>
	
	
	<s:layout>
		<s:VerticalLayout 
			paddingTop="10" paddingBottom="10"
			paddingRight="10" paddingLeft="10"
			/>
	</s:layout>
	
	<!-- GUI ______________________________________________________________________ -->
	
	<s:Button label="&lt;&lt; Back" click="model.cancelEmployeeEdits()" />
	
	<mx:Form defaultButton="{ submit }">
		
		<mx:FormItem label="First Name:"  required="true">
			<s:TextInput id="firstname"
				errorString="{ model.firstnameErrorString }"
				text="{ model.selectedEmployee.firstname}"
				change="model.updateFirstName( firstname.text )" />
		</mx:FormItem>
		
		<mx:FormItem label="Last Name:"  required="true">
			<s:TextInput id="lastname" 
				errorString="{ model.lastNameErrorString }"
				text="{model.selectedEmployee.lastname}" 
				change="model.updateLastName( lastname.text )"/>
		</mx:FormItem>
		
		<mx:FormItem label="Start Date:">
			<mx:DateField id="startdate" 
				selectedDate="{ model.selectedEmployee.startdate }"
				change="model.updateStartDate( startdate.selectedDate )" />
		</mx:FormItem>
		
		<mx:FormItem label="Email:"  required="true">
			<s:TextInput id="email"
				 errorString="{ model.emailErrorString }"
				 text="{model.selectedEmployee.email}"
				 change="model.updateEmail( email.text )"/>
		</mx:FormItem>
		
		<mx:FormItem direction="horizontal">
			<s:Button label="Submit" 
				click="model.saveEmployee( )" 
				id="submit" />
				
			<s:Button label="Delete"
				click="Alert.show(	'Are you sure you want to delete this employee?',
									null,
									Alert.OK | Alert.CANCEL,
									this,
									deleteEmployee,
									null,
									Alert.OK );" />
		</mx:FormItem>
	</mx:Form>
	
</s:Panel>